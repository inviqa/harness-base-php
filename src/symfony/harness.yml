---
harness('inviqa/symfony'):
  description: A docker based development environment for Symfony
  require:
    services:
      - proxy
      - mail
    confd:
      - harness:/
---
attributes:
  app:
    web_owner: www-data
    web_group: www-data
    web_writable_dirs:
      - '/app/var/'
    services:
      - chrome
      - mysql
  backend:
    build:
      steps:
        - task composer:install
    install:
      steps:
        - run console doctrine:database:create --if-not-exists
        - task overlay:apply
        - task assets:dump
    init:
      steps:
        - passthru console doctrine:migrations:migrate --no-interaction --allow-no-migration
    migrate:
      steps:
        - ~
        - passthru console doctrine:migrations:migrate --no-interaction --allow-no-migration
  symfony:
    secret: XuRDfjlBY7bg2yE0pbGzzS4NOet4ZWhGXdPGsoDCW5MLJip44bsD5t694zlT353tBznCj3Yi3S99M29s3k0lndZogFVqDy2FLoF3
---
import:
  - harness/config/*.yml
  - harness/attributes/*.yml
  - harness/attributes/environment/={env('MY127WS_ENV','local')}.yml
